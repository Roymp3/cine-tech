<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Comentários</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background-color: #f9f9f9;
        }
        button {
            padding: 8px 16px;
            background-color: #494850;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        input, textarea {
            padding: 8px;
            margin-bottom: 10px;
            width: 100%;
        }
        pre {
            background-color: #eee;
            padding: 10px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>Teste do Sistema de Comentários</h1>

    <div class="container">
        <div class="card">
            <h2>Verificar Status de Login</h2>
            <button id="btnVerificarLogin">Verificar Login</button>
            <pre id="loginStatus">Clique no botão para verificar</pre>
        </div>

        <div class="card">
            <h2>Listar Comentários</h2>
            <div>
                <label for="idFilme">ID do Filme:</label>
                <input type="number" id="idFilme" value="1">
            </div>
            <button id="btnListarComentarios">Listar Comentários</button>
            <pre id="comentariosResult">Clique no botão para listar</pre>
        </div>

        <div class="card">
            <h2>Adicionar Comentário</h2>
            <div>
                <label for="idFilmeAdd">ID do Filme:</label>
                <input type="number" id="idFilmeAdd" value="1">
            </div>
            <div>
                <label for="textoComentario">Texto:</label>
                <textarea id="textoComentario" rows="4" placeholder="Digite seu comentário aqui"></textarea>
            </div>
            <div>
                <label for="avaliacao">Avaliação (1-5):</label>
                <input type="number" id="avaliacao" min="1" max="5" value="5">
            </div>
            <button id="btnAdicionarComentario">Adicionar Comentário</button>
            <pre id="adicionarResult">Clique no botão para adicionar</pre>
        </div>

        <div class="card">
            <h2>Reagir a Comentário</h2>
            <div>
                <label for="idComentario">ID do Comentário:</label>
                <input type="number" id="idComentario" value="1">
            </div>
            <div>
                <label>Reação:</label>
                <label><input type="radio" name="reacao" value="true" checked> Like</label>
                <label><input type="radio" name="reacao" value="false"> Dislike</label>
            </div>
            <button id="btnReagir">Reagir</button>
            <pre id="reagirResult">Clique no botão para reagir</pre>
        </div>

        <div class="card">
            <h2>Excluir Comentário</h2>
            <div>
                <label for="idComentarioExcluir">ID do Comentário:</label>
                <input type="number" id="idComentarioExcluir" value="1">
            </div>
            <button id="btnExcluir">Excluir</button>
            <pre id="excluirResult">Clique no botão para excluir</pre>
        </div>
    </div>

    <script>
        document.getElementById('btnVerificarLogin').addEventListener('click', function() {
            fetch('/comentarios?acao=verificarUsuario')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('loginStatus').textContent = JSON.stringify(data, null, 2);
                })
                .catch(error => {
                    document.getElementById('loginStatus').textContent = 'Erro: ' + error.message;
                });
        });

        document.getElementById('btnListarComentarios').addEventListener('click', function() {
            const idFilme = document.getElementById('idFilme').value;
            fetch(`/comentarios?acao=listar&idFilme=${idFilme}`)
                .then(response => response.json())
                .then(data => {
                    document.getElementById('comentariosResult').textContent = JSON.stringify(data, null, 2);
                })
                .catch(error => {
                    document.getElementById('comentariosResult').textContent = 'Erro: ' + error.message;
                });
        });

        document.getElementById('btnAdicionarComentario').addEventListener('click', function() {
            const idFilme = document.getElementById('idFilmeAdd').value;
            const texto = document.getElementById('textoComentario').value;
            const avaliacao = document.getElementById('avaliacao').value;

            fetch('/comentarios?acao=adicionar', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    idFilme: idFilme,
                    texto: texto,
                    avaliacao: avaliacao
                })
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('adicionarResult').textContent = JSON.stringify(data, null, 2);
            })
            .catch(error => {
                document.getElementById('adicionarResult').textContent = 'Erro: ' + error.message;
            });
        });

        document.getElementById('btnReagir').addEventListener('click', function() {
            const idComentario = document.getElementById('idComentario').value;
            const like = document.querySelector('input[name="reacao"]:checked').value === 'true';

            fetch('/comentarios?acao=reagir', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    idComentario: idComentario,
                    like: like
                })
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('reagirResult').textContent = JSON.stringify(data, null, 2);
            })
            .catch(error => {
                document.getElementById('reagirResult').textContent = 'Erro: ' + error.message;
            });
        });

        document.getElementById('btnExcluir').addEventListener('click', function() {
            const idComentario = document.getElementById('idComentarioExcluir').value;

            if (!confirm('Tem certeza que deseja excluir este comentário?')) {
                return;
            }

            fetch('/comentarios?acao=excluir', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    idComentario: idComentario
                })
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('excluirResult').textContent = JSON.stringify(data, null, 2);
            })
            .catch(error => {
                document.getElementById('excluirResult').textContent = 'Erro: ' + error.message;
            });
        });
    </script>
</body>
</html>
